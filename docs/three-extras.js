import{O as H,V as A,a as M,M as _}from"./three-core.js";class C extends H{constructor(i=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=i,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new A(.5,.5),this.addEventListener("removed",function(){this.traverse(function(l){l.element instanceof Element&&l.element.parentNode!==null&&l.element.parentNode.removeChild(l.element)})})}copy(i,l){return super.copy(i,l),this.element=i.element.cloneNode(!0),this.center=i.center,this}}const y=new M,P=new _,g=new _,T=new M,R=new M;class O{constructor(i={}){const l=this;let f,u,c,r;const h={objects:new WeakMap},m=i.element!==void 0?i.element:document.createElement("div");m.style.overflow="hidden",this.domElement=m,this.getSize=function(){return{width:f,height:u}},this.render=function(e,n){e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),n.parent===null&&n.matrixWorldAutoUpdate===!0&&n.updateMatrixWorld(),P.copy(n.matrixWorldInverse),g.multiplyMatrices(n.projectionMatrix,P),x(e,e,n),p(e)},this.setSize=function(e,n){f=e,u=n,c=f/2,r=u/2,m.style.width=e+"px",m.style.height=n+"px"};function x(e,n,o){if(e.isCSS2DObject){y.setFromMatrixPosition(e.matrixWorld),y.applyMatrix4(g);const t=e.visible===!0&&y.z>=-1&&y.z<=1&&e.layers.test(o.layers)===!0;if(e.element.style.display=t===!0?"":"none",t===!0){e.onBeforeRender(l,n,o);const S=e.element;S.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(y.x*c+c)+"px,"+(-y.y*r+r)+"px)",S.parentNode!==m&&m.appendChild(S),e.onAfterRender(l,n,o)}const d={distanceToCameraSquared:a(o,e)};h.objects.set(e,d)}for(let t=0,d=e.children.length;t<d;t++)x(e.children[t],n,o)}function a(e,n){return T.setFromMatrixPosition(e.matrixWorld),R.setFromMatrixPosition(n.matrixWorld),T.distanceToSquared(R)}function s(e){const n=[];return e.traverse(function(o){o.isCSS2DObject&&n.push(o)}),n}function p(e){const n=s(e).sort(function(t,d){if(t.renderOrder!==d.renderOrder)return d.renderOrder-t.renderOrder;const S=h.objects.get(t).distanceToCameraSquared,E=h.objects.get(d).distanceToCameraSquared;return S-E}),o=n.length;for(let t=0,d=n.length;t<d;t++)n[t].element.style.zIndex=o-t}}}var w=function(){var v=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(a){a.preventDefault(),f(++v%i.children.length)},!1);function l(a){return i.appendChild(a.dom),a}function f(a){for(var s=0;s<i.children.length;s++)i.children[s].style.display=s===a?"block":"none";v=a}var u=(performance||Date).now(),c=u,r=0,h=l(new w.Panel("FPS","#0ff","#002")),m=l(new w.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var x=l(new w.Panel("MB","#f08","#201"));return f(0),{REVISION:16,dom:i,addPanel:l,showPanel:f,begin:function(){u=(performance||Date).now()},end:function(){r++;var a=(performance||Date).now();if(m.update(a-u,200),a>=c+1e3&&(h.update(r*1e3/(a-c),100),c=a,r=0,x)){var s=performance.memory;x.update(s.usedJSHeapSize/1048576,s.jsHeapSizeLimit/1048576)}return a},update:function(){u=this.end()},domElement:i,setMode:f}};w.Panel=function(v,i,l){var f=1/0,u=0,c=Math.round,r=c(window.devicePixelRatio||1),h=80*r,m=48*r,x=3*r,a=2*r,s=3*r,p=15*r,e=74*r,n=30*r,o=document.createElement("canvas");o.width=h,o.height=m,o.style.cssText="width:80px;height:48px";var t=o.getContext("2d");return t.font="bold "+9*r+"px Helvetica,Arial,sans-serif",t.textBaseline="top",t.fillStyle=l,t.fillRect(0,0,h,m),t.fillStyle=i,t.fillText(v,x,a),t.fillRect(s,p,e,n),t.fillStyle=l,t.globalAlpha=.9,t.fillRect(s,p,e,n),{dom:o,update:function(d,S){f=Math.min(f,d),u=Math.max(u,d),t.fillStyle=l,t.globalAlpha=1,t.fillRect(0,0,h,p),t.fillStyle=i,t.fillText(c(d)+" "+v+" ("+c(f)+"-"+c(u)+")",x,a),t.drawImage(o,s+r,p,e-r,n,s,p,e-r,n),t.fillRect(s+e-r,p,r,n),t.fillStyle=l,t.globalAlpha=.9,t.fillRect(s+e-r,p,r,c((1-d/S)*n))}}};const W=w;export{C,W as S,O as a};
